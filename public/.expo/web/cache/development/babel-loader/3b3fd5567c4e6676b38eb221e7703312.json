{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nimport * as array from 'd3-array';\nimport * as scale from 'd3-scale';\nimport * as shape from 'd3-shape';\nimport PropTypes from 'prop-types';\nimport React, { PureComponent } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Svg from 'react-native-svg';\nimport Path from \"../animated-path\";\n\nvar BarChart = function (_PureComponent) {\n  _inherits(BarChart, _PureComponent);\n\n  var _super = _createSuper(BarChart);\n\n  function BarChart() {\n    var _this;\n\n    _classCallCheck(this, BarChart);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      width: 0,\n      height: 0\n    });\n\n    return _this;\n  }\n\n  _createClass(BarChart, [{\n    key: \"_onLayout\",\n    value: function _onLayout(event) {\n      var _event$nativeEvent$la = event.nativeEvent.layout,\n          height = _event$nativeEvent$la.height,\n          width = _event$nativeEvent$la.width;\n      this.setState({\n        height: height,\n        width: width\n      });\n    }\n  }, {\n    key: \"calcXScale\",\n    value: function calcXScale(domain) {\n      var _this$props = this.props,\n          horizontal = _this$props.horizontal,\n          _this$props$contentIn = _this$props.contentInset,\n          _this$props$contentIn2 = _this$props$contentIn.left,\n          left = _this$props$contentIn2 === void 0 ? 0 : _this$props$contentIn2,\n          _this$props$contentIn3 = _this$props$contentIn.right,\n          right = _this$props$contentIn3 === void 0 ? 0 : _this$props$contentIn3,\n          spacingInner = _this$props.spacingInner,\n          spacingOuter = _this$props.spacingOuter,\n          clamp = _this$props.clamp;\n      var width = this.state.width;\n\n      if (horizontal) {\n        return scale.scaleLinear().domain(domain).range([left, width - right]).clamp(clamp);\n      }\n\n      return scale.scaleBand().domain(domain).range([left, width - right]).paddingInner([spacingInner]).paddingOuter([spacingOuter]);\n    }\n  }, {\n    key: \"calcYScale\",\n    value: function calcYScale(domain) {\n      var _this$props2 = this.props,\n          horizontal = _this$props2.horizontal,\n          _this$props2$contentI = _this$props2.contentInset,\n          _this$props2$contentI2 = _this$props2$contentI.top,\n          top = _this$props2$contentI2 === void 0 ? 0 : _this$props2$contentI2,\n          _this$props2$contentI3 = _this$props2$contentI.bottom,\n          bottom = _this$props2$contentI3 === void 0 ? 0 : _this$props2$contentI3,\n          spacingInner = _this$props2.spacingInner,\n          spacingOuter = _this$props2.spacingOuter,\n          clamp = _this$props2.clamp;\n      var height = this.state.height;\n\n      if (horizontal) {\n        return scale.scaleBand().domain(domain).range([top, height - bottom]).paddingInner([spacingInner]).paddingOuter([spacingOuter]);\n      }\n\n      return scale.scaleLinear().domain(domain).range([height - bottom, top]).clamp(clamp);\n    }\n  }, {\n    key: \"calcAreas\",\n    value: function calcAreas(x, y) {\n      var _this$props3 = this.props,\n          horizontal = _this$props3.horizontal,\n          data = _this$props3.data,\n          yAccessor = _this$props3.yAccessor;\n      var values = data.map(function (item) {\n        return yAccessor({\n          item: item\n        });\n      });\n\n      if (horizontal) {\n        return data.map(function (bar, index) {\n          return {\n            bar: bar,\n            path: shape.area().y(function (value, _index) {\n              return _index === 0 ? y(index) : y(index) + y.bandwidth();\n            }).x0(x(0)).x1(function (value) {\n              return x(value);\n            }).defined(function (value) {\n              return typeof value === 'number';\n            })([values[index], values[index]])\n          };\n        });\n      }\n\n      return data.map(function (bar, index) {\n        return {\n          bar: bar,\n          path: shape.area().y0(y(0)).y1(function (value) {\n            return y(value);\n          }).x(function (value, _index) {\n            return _index === 0 ? x(index) : x(index) + x.bandwidth();\n          }).defined(function (value) {\n            return typeof value === 'number';\n          })([values[index], values[index]])\n        };\n      });\n    }\n  }, {\n    key: \"calcExtent\",\n    value: function calcExtent() {\n      var _this$props4 = this.props,\n          data = _this$props4.data,\n          gridMin = _this$props4.gridMin,\n          gridMax = _this$props4.gridMax,\n          yAccessor = _this$props4.yAccessor;\n      var values = data.map(function (obj) {\n        return yAccessor({\n          item: obj\n        });\n      });\n      var extent = array.extent([].concat(_toConsumableArray(values), [gridMax, gridMin]));\n      var _this$props5 = this.props,\n          _this$props5$yMin = _this$props5.yMin,\n          yMin = _this$props5$yMin === void 0 ? extent[0] : _this$props5$yMin,\n          _this$props5$yMax = _this$props5.yMax,\n          yMax = _this$props5$yMax === void 0 ? extent[1] : _this$props5$yMax;\n      return [yMin, yMax];\n    }\n  }, {\n    key: \"calcIndexes\",\n    value: function calcIndexes() {\n      var data = this.props.data;\n      return data.map(function (_, index) {\n        return index;\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props6 = this.props,\n          data = _this$props6.data,\n          animate = _this$props6.animate,\n          animationDuration = _this$props6.animationDuration,\n          style = _this$props6.style,\n          numberOfTicks = _this$props6.numberOfTicks,\n          svg = _this$props6.svg,\n          horizontal = _this$props6.horizontal,\n          children = _this$props6.children;\n      var _this$state = this.state,\n          height = _this$state.height,\n          width = _this$state.width;\n\n      if (data.length === 0) {\n        return React.createElement(View, {\n          style: style\n        });\n      }\n\n      var extent = this.calcExtent();\n      var indexes = this.calcIndexes();\n      var ticks = array.ticks(extent[0], extent[1], numberOfTicks);\n      var xDomain = horizontal ? extent : indexes;\n      var yDomain = horizontal ? indexes : extent;\n      var x = this.calcXScale(xDomain);\n      var y = this.calcYScale(yDomain);\n      var bandwidth = horizontal ? y.bandwidth() : x.bandwidth();\n      var areas = this.calcAreas(x, y).filter(function (area) {\n        return area.bar !== null && area.bar !== undefined && area.path !== null;\n      });\n      var extraProps = {\n        x: x,\n        y: y,\n        width: width,\n        height: height,\n        bandwidth: bandwidth,\n        ticks: ticks,\n        data: data\n      };\n      return React.createElement(View, {\n        style: style\n      }, React.createElement(View, {\n        style: {\n          flex: 1\n        },\n        onLayout: function onLayout(event) {\n          return _this2._onLayout(event);\n        }\n      }, height > 0 && width > 0 && React.createElement(Svg, {\n        style: {\n          height: height,\n          width: width\n        }\n      }, React.Children.map(children, function (child) {\n        if (child && child.props.belowChart) {\n          return React.cloneElement(child, extraProps);\n        }\n      }), areas.map(function (area, index) {\n        var _area$bar$svg = area.bar.svg,\n            barSvg = _area$bar$svg === void 0 ? {} : _area$bar$svg,\n            path = area.path;\n        return React.createElement(Path, _extends({\n          key: index\n        }, svg, barSvg, {\n          d: path,\n          animate: animate,\n          animationDuration: animationDuration\n        }));\n      }), React.Children.map(children, function (child) {\n        if (child && !child.props.belowChart) {\n          return React.cloneElement(child, extraProps);\n        }\n      }))));\n    }\n  }]);\n\n  return BarChart;\n}(PureComponent);\n\nBarChart.propTypes = {\n  data: PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.number, PropTypes.object])).isRequired,\n  style: PropTypes.any,\n  spacingInner: PropTypes.number,\n  spacingOuter: PropTypes.number,\n  animate: PropTypes.bool,\n  animationDuration: PropTypes.number,\n  contentInset: PropTypes.shape({\n    top: PropTypes.number,\n    left: PropTypes.number,\n    right: PropTypes.number,\n    bottom: PropTypes.number\n  }),\n  numberOfTicks: PropTypes.number,\n  gridMin: PropTypes.number,\n  gridMax: PropTypes.number,\n  svg: PropTypes.object,\n  yMin: PropTypes.any,\n  yMax: PropTypes.any,\n  clamp: PropTypes.bool\n};\nBarChart.defaultProps = {\n  spacingInner: 0.05,\n  spacingOuter: 0.05,\n  contentInset: {},\n  numberOfTicks: 10,\n  svg: {},\n  yAccessor: function yAccessor(_ref) {\n    var item = _ref.item;\n    return item;\n  }\n};\nexport default BarChart;","map":{"version":3,"sources":["bar-chart.js"],"names":["width","height","_onLayout","nativeEvent","layout","calcXScale","contentInset","left","right","clamp","scale","calcYScale","top","bottom","calcAreas","yAccessor","values","item","bar","path","shape","_index","y","x","value","calcExtent","obj","extent","array","yMin","yMax","calcIndexes","data","render","children","style","indexes","ticks","xDomain","horizontal","yDomain","bandwidth","areas","area","extraProps","flex","event","child","React","svg","barSvg","index","animationDuration","BarChart","PropTypes","spacingInner","spacingOuter","animate","number","numberOfTicks","gridMin","gridMax","bool"],"mappings":"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","sourcesContent":["import * as array from 'd3-array'\nimport * as scale from 'd3-scale'\nimport * as shape from 'd3-shape'\nimport PropTypes from 'prop-types'\nimport React, { PureComponent } from 'react'\nimport { View } from 'react-native'\nimport Svg from 'react-native-svg'\nimport Path from '../animated-path'\n\nclass BarChart extends PureComponent {\n    state = {\n        width: 0,\n        height: 0,\n    }\n\n    _onLayout(event) {\n        const {\n            nativeEvent: {\n                layout: { height, width },\n            },\n        } = event\n        this.setState({ height, width })\n    }\n\n    calcXScale(domain) {\n        const {\n            horizontal,\n            contentInset: { left = 0, right = 0 },\n            spacingInner,\n            spacingOuter,\n            clamp,\n        } = this.props\n\n        const { width } = this.state\n\n        if (horizontal) {\n            return scale\n                .scaleLinear()\n                .domain(domain)\n                .range([left, width - right])\n                .clamp(clamp)\n        }\n\n        return scale\n            .scaleBand()\n            .domain(domain)\n            .range([left, width - right])\n            .paddingInner([spacingInner])\n            .paddingOuter([spacingOuter])\n    }\n\n    calcYScale(domain) {\n        const {\n            horizontal,\n            contentInset: { top = 0, bottom = 0 },\n            spacingInner,\n            spacingOuter,\n            clamp,\n        } = this.props\n\n        const { height } = this.state\n\n        if (horizontal) {\n            return scale\n                .scaleBand()\n                .domain(domain)\n                .range([top, height - bottom])\n                .paddingInner([spacingInner])\n                .paddingOuter([spacingOuter])\n        }\n\n        return scale\n            .scaleLinear()\n            .domain(domain)\n            .range([height - bottom, top])\n            .clamp(clamp)\n    }\n\n    calcAreas(x, y) {\n        const { horizontal, data, yAccessor } = this.props\n\n        const values = data.map((item) => yAccessor({ item }))\n\n        if (horizontal) {\n            return data.map((bar, index) => ({\n                bar,\n                path: shape\n                    .area()\n                    .y((value, _index) => (_index === 0 ? y(index) : y(index) + y.bandwidth()))\n                    .x0(x(0))\n                    .x1((value) => x(value))\n                    .defined((value) => typeof value === 'number')([values[index], values[index]]),\n            }))\n        }\n\n        return data.map((bar, index) => ({\n            bar,\n            path: shape\n                .area()\n                .y0(y(0))\n                .y1((value) => y(value))\n                .x((value, _index) => (_index === 0 ? x(index) : x(index) + x.bandwidth()))\n                .defined((value) => typeof value === 'number')([values[index], values[index]]),\n        }))\n    }\n\n    calcExtent() {\n        const { data, gridMin, gridMax, yAccessor } = this.props\n        const values = data.map((obj) => yAccessor({ item: obj }))\n\n        const extent = array.extent([...values, gridMax, gridMin])\n\n        const { yMin = extent[0], yMax = extent[1] } = this.props\n\n        return [yMin, yMax]\n    }\n\n    calcIndexes() {\n        const { data } = this.props\n        return data.map((_, index) => index)\n    }\n\n    render() {\n        const { data, animate, animationDuration, style, numberOfTicks, svg, horizontal, children } = this.props\n\n        const { height, width } = this.state\n\n        if (data.length === 0) {\n            return <View style={style} />\n        }\n\n        const extent = this.calcExtent()\n        const indexes = this.calcIndexes()\n        const ticks = array.ticks(extent[0], extent[1], numberOfTicks)\n\n        const xDomain = horizontal ? extent : indexes\n        const yDomain = horizontal ? indexes : extent\n\n        const x = this.calcXScale(xDomain)\n        const y = this.calcYScale(yDomain)\n\n        const bandwidth = horizontal ? y.bandwidth() : x.bandwidth()\n\n        const areas = this.calcAreas(x, y).filter(\n            (area) => area.bar !== null && area.bar !== undefined && area.path !== null\n        )\n\n        const extraProps = {\n            x,\n            y,\n            width,\n            height,\n            bandwidth,\n            ticks,\n            data,\n        }\n\n        return (\n            <View style={style}>\n                <View style={{ flex: 1 }} onLayout={(event) => this._onLayout(event)}>\n                    {height > 0 && width > 0 && (\n                        <Svg style={{ height, width }}>\n                            {React.Children.map(children, (child) => {\n                                if (child && child.props.belowChart) {\n                                    return React.cloneElement(child, extraProps)\n                                }\n                            })}\n                            {areas.map((area, index) => {\n                                const {\n                                    bar: { svg: barSvg = {} },\n                                    path,\n                                } = area\n\n                                return (\n                                    <Path\n                                        key={index}\n                                        {...svg}\n                                        {...barSvg}\n                                        d={path}\n                                        animate={animate}\n                                        animationDuration={animationDuration}\n                                    />\n                                )\n                            })}\n                            {React.Children.map(children, (child) => {\n                                if (child && !child.props.belowChart) {\n                                    return React.cloneElement(child, extraProps)\n                                }\n                            })}\n                        </Svg>\n                    )}\n                </View>\n            </View>\n        )\n    }\n}\n\nBarChart.propTypes = {\n    data: PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.number, PropTypes.object])).isRequired,\n    style: PropTypes.any,\n    spacingInner: PropTypes.number,\n    spacingOuter: PropTypes.number,\n    animate: PropTypes.bool,\n    animationDuration: PropTypes.number,\n    contentInset: PropTypes.shape({\n        top: PropTypes.number,\n        left: PropTypes.number,\n        right: PropTypes.number,\n        bottom: PropTypes.number,\n    }),\n    numberOfTicks: PropTypes.number,\n    gridMin: PropTypes.number,\n    gridMax: PropTypes.number,\n    svg: PropTypes.object,\n\n    yMin: PropTypes.any,\n    yMax: PropTypes.any,\n    clamp: PropTypes.bool,\n}\n\nBarChart.defaultProps = {\n    spacingInner: 0.05,\n    spacingOuter: 0.05,\n    contentInset: {},\n    numberOfTicks: 10,\n    svg: {},\n    yAccessor: ({ item }) => item,\n}\n\nexport default BarChart\n"]},"metadata":{},"sourceType":"module"}